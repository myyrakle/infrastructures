# 배포 모드: simple-scalable (read/write 분리, 중소규모에 적합)
deploymentMode: SimpleScalable

loki:
  # 인증 비활성화 (내부 사용)
  auth_enabled: false

  # 공통 설정
  commonConfig:
    replication_factor: 1

  # 스토리지 설정
  storage:
    type: filesystem

  # 스키마 설정
  schemaConfig:
    configs:
      - from: "2024-01-01"
        store: tsdb
        object_store: filesystem
        schema: v13
        index:
          prefix: index_
          period: 24h

  # 보존 기간 설정
  limits_config:
    retention_period: 168h  # 7일
    max_query_length: 168h
    # 수집 제한
    ingestion_rate_mb: 10
    ingestion_burst_size_mb: 20
    per_stream_rate_limit: 5MB
    per_stream_rate_limit_burst: 10MB
    max_entries_limit_per_query: 10000
    max_streams_per_user: 0
    max_global_streams_per_user: 0

  # Compactor 설정 (오래된 로그 자동 삭제)
  compactor:
    retention_enabled: true
    delete_request_store: filesystem
    retention_delete_delay: 2h
    retention_delete_worker_count: 150
    compaction_interval: 10m

# Write 컴포넌트 (로그 수신 및 저장)
write:
  replicas: 3
  persistence:
    enabled: true
    size: 35Gi
    storageClass: local-path
  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 200m
      memory: 512Mi

# Read 컴포넌트 (쿼리 처리)
read:
  replicas: 2
  persistence:
    enabled: true
    size: 10Gi
    storageClass: local-path
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 256Mi

# Backend 컴포넌트 (compactor 등)
backend:
  replicas: 1
  persistence:
    enabled: true
    size: 10Gi
    storageClass: local-path
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 256Mi

# Gateway (Nginx - 선택적)
gateway:
  enabled: true
  replicas: 1
  resources:
    limits:
      cpu: 200m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 128Mi

# 단일 바이너리 모드 비활성화
singleBinary:
  replicas: 0

# 모니터링
monitoring:
  selfMonitoring:
    enabled: false
    grafanaAgent:
      installOperator: false
  lokiCanary:
    enabled: false

# 테스트 비활성화
test:
  enabled: false
